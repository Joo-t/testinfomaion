<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INHAIR - 스케줄관리</title>
    <link rel="stylesheet" href="common.css">
    <link rel="stylesheet" href="page5.css">
</head>
<body>
    <!-- 상단 -->
    <header>
        <nav>
            <div class="logo">INHAIR</div>
            <div class="user-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 12C14.7614 12 17 9.76142 17 7C17 4.23858 14.7614 2 12 2C9.23858 2 7 4.23858 7 7C7 9.76142 9.23858 12 12 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M20.59 22C20.59 18.13 16.74 15 12 15C7.26 15 3.41 18.13 3.41 22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
        </nav>
    </header>

    <!-- 목록으로 가기 버튼 -->
    <a href="index.html" class="back-to-list-btn">목록으로 가기</a>

    <!-- 중단 -->
    <main style="padding-bottom: 80px; padding-top: 1rem;">
        <div class="page-title">
            내 스케줄 등록
        </div>
        <div class="schedule-info">
            원하는 날짜와 시간을 등록하면 의사가 확인하고 매칭해드립니다.
        </div>
        <div class="calendar-container-wrapper">
            <div class="calendar-vertical-section">
                <!-- 1일부터 31일까지 동적으로 생성 -->
                <div class="day-row" data-day="1">
                    <div class="day-header">1일</div>
                    <div class="day-schedule">
                        <button class="add-schedule-btn" onclick="openScheduleModal(1)" title="스케줄 추가">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            스케줄 추가
                        </button>
                    </div>
                </div>
                <div class="day-row" data-day="2">
                    <div class="day-header">2일</div>
                    <div class="day-schedule">
                        <div class="schedule-block registered">
                            <div class="schedule-time">1~3시</div>
                            <div class="schedule-actions">
                                <span class="status-badge">등록완료</span>
                                <button class="edit-btn" onclick="openScheduleModal(2, '1~3시')" title="수정">수정</button>
                                <button class="delete-btn" onclick="deleteSchedule(2, '1~3시')" title="삭제">삭제</button>
                            </div>
                        </div>
                        <button class="add-schedule-btn" onclick="openScheduleModal(2)" title="스케줄 추가">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            스케줄 추가
                        </button>
                    </div>
                </div>
                <div class="day-row" data-day="3">
                    <div class="day-header">3일</div>
                    <div class="day-schedule">
                        <div class="schedule-block registered">
                            <div class="schedule-time">2~4시</div>
                            <div class="schedule-actions">
                                <span class="status-badge">등록완료</span>
                                <button class="edit-btn" onclick="openScheduleModal(3, '2~4시')" title="수정">수정</button>
                                <button class="delete-btn" onclick="deleteSchedule(3, '2~4시')" title="삭제">삭제</button>
                            </div>
                        </div>
                        <div class="schedule-block registered">
                            <div class="schedule-time">5~7시</div>
                            <div class="schedule-actions">
                                <span class="status-badge">등록완료</span>
                                <button class="edit-btn" onclick="openScheduleModal(3, '5~7시')" title="수정">수정</button>
                                <button class="delete-btn" onclick="deleteSchedule(3, '5~7시')" title="삭제">삭제</button>
                            </div>
                        </div>
                        <button class="add-schedule-btn" onclick="openScheduleModal(3)" title="스케줄 추가">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            스케줄 추가
                        </button>
                    </div>
                </div>
                <!-- 4일부터 31일까지 빈 상태로 생성 -->
                <div class="day-row" data-day="4">
                    <div class="day-header">4일</div>
                    <div class="day-schedule">
                        <button class="add-schedule-btn" onclick="openScheduleModal(4)" title="스케줄 추가">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            스케줄 추가
                        </button>
                    </div>
                </div>
                <div class="day-row" data-day="5">
                    <div class="day-header">5일</div>
                    <div class="day-schedule">
                        <button class="add-schedule-btn" onclick="openScheduleModal(5)" title="스케줄 추가">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            스케줄 추가
                        </button>
                    </div>
                </div>
                <!-- 나머지 날짜들도 동일한 패턴으로 생성 (간단히 표시) -->
                <div class="day-row" data-day="6">
                    <div class="day-header">6일</div>
                    <div class="day-schedule">
                        <button class="add-schedule-btn" onclick="openScheduleModal(6)" title="스케줄 추가">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            스케줄 추가
                        </button>
                    </div>
                </div>
                <div class="day-row" data-day="7">
                    <div class="day-header">7일</div>
                    <div class="day-schedule">
                        <button class="add-schedule-btn" onclick="openScheduleModal(7)" title="스케줄 추가">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                            </svg>
                            스케줄 추가
                        </button>
                    </div>
                </div>
                <!-- 8일부터 31일까지는 JavaScript로 동적 생성 -->
            </div>
        </div>
    </main>

    <!-- 스케줄 등록 모달 -->
    <div id="scheduleModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">스케줄 등록</h3>
                <button class="close-btn" onclick="closeScheduleModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>날짜</label>
                    <input type="text" id="scheduleDay" readonly>
                </div>
                <div class="form-group">
                    <label>시작 시간</label>
                    <select id="startTime">
                        <option value="">선택</option>
                        <option value="1">1시</option>
                        <option value="2">2시</option>
                        <option value="3">3시</option>
                        <option value="4">4시</option>
                        <option value="5">5시</option>
                        <option value="6">6시</option>
                        <option value="7">7시</option>
                        <option value="8">8시</option>
                        <option value="9">9시</option>
                        <option value="10">10시</option>
                        <option value="11">11시</option>
                        <option value="12">12시</option>
                        <option value="13">13시</option>
                        <option value="14">14시</option>
                        <option value="15">15시</option>
                        <option value="16">16시</option>
                        <option value="17">17시</option>
                        <option value="18">18시</option>
                        <option value="19">19시</option>
                        <option value="20">20시</option>
                        <option value="21">21시</option>
                        <option value="22">22시</option>
                        <option value="23">23시</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>종료 시간</label>
                    <select id="endTime">
                        <option value="">선택</option>
                        <option value="1">1시</option>
                        <option value="2">2시</option>
                        <option value="3">3시</option>
                        <option value="4">4시</option>
                        <option value="5">5시</option>
                        <option value="6">6시</option>
                        <option value="7">7시</option>
                        <option value="8">8시</option>
                        <option value="9">9시</option>
                        <option value="10">10시</option>
                        <option value="11">11시</option>
                        <option value="12">12시</option>
                        <option value="13">13시</option>
                        <option value="14">14시</option>
                        <option value="15">15시</option>
                        <option value="16">16시</option>
                        <option value="17">17시</option>
                        <option value="18">18시</option>
                        <option value="19">19시</option>
                        <option value="20">20시</option>
                        <option value="21">21시</option>
                        <option value="22">22시</option>
                        <option value="23">23시</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="cancel-btn" onclick="closeScheduleModal()">취소</button>
                <button class="submit-btn" onclick="saveSchedule()">등록</button>
            </div>
        </div>
    </div>

    <!-- 하단 -->
    <footer>
        <div class="footer-nav">
            <button class="footer-btn">내 프로필</button>
            <span class="footer-divider">|</span>
            <button class="footer-btn active">스케줄관리</button>
            <span class="footer-divider">|</span>
            <button class="footer-btn">강의자료</button>
        </div>
    </footer>

    <script>
        // 나머지 날짜들 동적 생성
        const calendarSection = document.querySelector('.calendar-vertical-section');
        for (let day = 8; day <= 31; day++) {
            const dayRow = document.createElement('div');
            dayRow.className = 'day-row';
            dayRow.setAttribute('data-day', day);
            dayRow.innerHTML = `
                <div class="day-header">${day}일</div>
                <div class="day-schedule">
                    <button class="add-schedule-btn" onclick="openScheduleModal(${day})" title="스케줄 추가">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 5V19M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        스케줄 추가
                    </button>
                </div>
            `;
            calendarSection.appendChild(dayRow);
        }

        let currentDay = null;
        let editingSchedule = null;

        function openScheduleModal(day, existingTime = null) {
            currentDay = day;
            editingSchedule = existingTime;
            const modal = document.getElementById('scheduleModal');
            const modalTitle = document.getElementById('modalTitle');
            const scheduleDayInput = document.getElementById('scheduleDay');
            
            scheduleDayInput.value = `${day}일`;
            modalTitle.textContent = existingTime ? '스케줄 수정' : '스케줄 등록';
            
            if (existingTime) {
                const [start, end] = existingTime.split('~');
                document.getElementById('startTime').value = parseInt(start);
                document.getElementById('endTime').value = parseInt(end.replace('시', ''));
            } else {
                document.getElementById('startTime').value = '';
                document.getElementById('endTime').value = '';
            }
            
            modal.style.display = 'flex';
        }

        function closeScheduleModal() {
            document.getElementById('scheduleModal').style.display = 'none';
            currentDay = null;
            editingSchedule = null;
        }

        function saveSchedule() {
            const startTime = document.getElementById('startTime').value;
            const endTime = document.getElementById('endTime').value;
            
            if (!startTime || !endTime) {
                alert('시작 시간과 종료 시간을 모두 선택해주세요.');
                return;
            }
            
            if (parseInt(startTime) >= parseInt(endTime)) {
                alert('종료 시간은 시작 시간보다 늦어야 합니다.');
                return;
            }
            
            const timeRange = `${startTime}~${endTime}시`;
            const dayRow = document.querySelector(`.day-row[data-day="${currentDay}"]`);
            const daySchedule = dayRow.querySelector('.day-schedule');
            
            if (editingSchedule) {
                // 수정 모드
                const scheduleBlock = Array.from(daySchedule.querySelectorAll('.schedule-block')).find(block => {
                    return block.querySelector('.schedule-time').textContent === editingSchedule;
                });
                if (scheduleBlock) {
                    scheduleBlock.querySelector('.schedule-time').textContent = timeRange;
                }
            } else {
                // 새로 추가
                const scheduleBlock = document.createElement('div');
                scheduleBlock.className = 'schedule-block registered';
                scheduleBlock.innerHTML = `
                    <div class="schedule-time">${timeRange}</div>
                    <div class="schedule-actions">
                        <span class="status-badge">등록완료</span>
                        <button class="edit-btn" onclick="openScheduleModal(${currentDay}, '${timeRange}')" title="수정">수정</button>
                        <button class="delete-btn" onclick="deleteSchedule(${currentDay}, '${timeRange}')" title="삭제">삭제</button>
                    </div>
                `;
                
                // "스케줄 추가" 버튼 앞에 삽입
                const addBtn = daySchedule.querySelector('.add-schedule-btn');
                daySchedule.insertBefore(scheduleBlock, addBtn);
            }
            
            closeScheduleModal();
        }

        function deleteSchedule(day, timeRange) {
            if (confirm(`정말 삭제하시겠습니까?\n${day}일 ${timeRange}`)) {
                const dayRow = document.querySelector(`.day-row[data-day="${day}"]`);
                const daySchedule = dayRow.querySelector('.day-schedule');
                const scheduleBlock = Array.from(daySchedule.querySelectorAll('.schedule-block')).find(block => {
                    return block.querySelector('.schedule-time').textContent === timeRange;
                });
                if (scheduleBlock) {
                    scheduleBlock.remove();
                }
            }
        }

        // 모달 외부 클릭 시 닫기
        window.onclick = function(event) {
            const modal = document.getElementById('scheduleModal');
            if (event.target === modal) {
                closeScheduleModal();
            }
        }
    </script>
</body>
</html>

